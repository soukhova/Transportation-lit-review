aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
guides(fill=guide_legend(title="Continent")) +
#scale_x_continuous(breaks = seq(2005,2022, by=1)) +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank())
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
guides(fill=guide_legend(title="Continent")) +
#scale_x_continuous(breaks = seq(2005,2022, by=1)) +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "top")
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
guides(fill=guide_legend(title="Continent")) +
#scale_x_continuous(breaks = seq(2005,2022, by=1)) +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom")
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
guides(fill=guide_legend(title="Continent")) +
#scale_x_continuous(breaks = seq(2005,2022, by=1)) +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom", legend.box="vertical")
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
guides(fill=guide_legend(title="Continent")) +
#scale_x_continuous(breaks = seq(2005,2022, by=1)) +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom", legend.box="vertical", legend.margin=margin())
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
guides(fill=guide_legend(title="Continent")) +
#scale_x_continuous(breaks = seq(2005,2022, by=1)) +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom", legend.box="vertical", legend.margin=margin(10))
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
guides(fill=guide_legend(title="Continent")) +
#scale_x_continuous(breaks = seq(2005,2022, by=1)) +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom", legend.box="vertical", legend.margin=margin(-4))
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
guides(fill=guide_legend(title="Continent")) +
#scale_x_continuous(breaks = seq(2005,2022, by=1)) +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom") + guides(colour = guide_legend(nrow = 1))
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
#scale_x_continuous(breaks = seq(2005,2022, by=1)) +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom") + guides(fill = guide_legend(nrow = 1))
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
#scale_x_continuous(breaks = seq(2005,2022, by=1)) +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom") + guides(fill = guide_legend(nrow = 1),
title = element_blank())
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
guides(fill=guide_legend(title="Continent")) +
#scale_x_continuous(breaks = seq(2005,2022, by=1)) +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom") + guides(fill = guide_legend(nrow = 1,
title=NA))
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
guides(fill=guide_legend(title="Continent")) +
#scale_x_continuous(breaks = seq(2005,2022, by=1)) +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom") + guides(fill = guide_legend(nrow = 1,
title=NULL))
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom") + guides(fill = guide_legend(nrow = 1,
title=NULL))
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
coord_flip()+
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom") + guides(fill = guide_legend(nrow = 1,
title=NULL))
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
theme_classic() +
theme(text=element_text(size=10),
axis.title = element_blank(),
legend.position = "bottom") + guides(fill = guide_legend(nrow = 1,
title=NULL))
year_cont_plot
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom") + guides(fill = guide_legend(nrow = 1,
title=NULL))
year_cont_plot
stand_conc$
d
conc_count <- strsplit(Consensus_only_analysis$`_equity conceptualization`, "; ",
fixed = T)
conc_count <- data.frame(
id=rep(Consensus_only_analysis$`_equity conceptualization`, lengths(conc_count)),
conc_count=unlist(conc_count))
conc_count <- conc_count |> group_by(conc_count) |> summarize(count = n())
stand_count <- strsplit(Consensus_only_analysis$`_type of equity standard2`, "; ",
fixed = T)
stand_count <- data.frame(
id=rep(Consensus_only_analysis$`_type of equity standard2`, lengths(stand_count)),
stand_count=unlist(stand_count))
stand_count <- stand_count |> group_by(stand_count) |> summarize(count = n())
stand_count$count
(stand_count$count[3] /sum(stand_count$count)) |> percent()
(stand_count$count[4] /sum(stand_count$count)) |> percent()
(stand_count$count[4] /sum(stand_count$count)) |> percent(accuracy=L:)
(stand_count$count[4] /sum(stand_count$count)) |> percent(accuracy=2L:)
(stand_count$count[4] /sum(stand_count$count)) |> percent(accuracy=2L)
(stand_count$count[4] /sum(stand_count$count)) |> percent(decimals=2)
(stand_count$count[4] /sum(stand_count$count)) |> percent(decimals=0.01)
(stand_count$count[4] /sum(stand_count$count)) |> percent(decimals=0.1)
(stand_count$count[4] /sum(stand_count$count)) |> percent(digits=0.1)
(stand_count$count[4] /sum(stand_count$count)) |> percent(digits=0.01)
(stand_count$count[4] /sum(stand_count$count)) |> percent(digits=0.001)
(stand_count$count[4] /sum(stand_count$count)) |> percent(digits=0.01)
(stand_count$count[4] /sum(stand_count$count)) |> percent(digits=0.05)
(stand_count$count[4] /sum(stand_count$count)) |> percent(accuracy=0.01)
(stand_count$count[4] /sum(stand_count$count)) |> percent(accuracy=0.1)
(stand_count$count[3] /sum(stand_count$count)) |> percent(accuracy=0.1)
standards_conc$total_perc_in_conc
standards_conc %>% filter(conc =="Rights" & std_mcat =="Infrastructure") %>% select(total_perc_in_conc) %>% pull() %>% percent(accuracy=2L)
stand_count
conc_count
(conc_count$count[3]/sum(conc_count$count)) |> percent()
(stand_count$count[3]/sum(stand_count$count)) |> percent()
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)
library(huxtable)
library(sf)
library(ggplot2)
library(tidyverse)
library(readxl)
library(DiagrammeR)
library(scales)
library(corrplot)
Pflow_chart <- grViz("digraph flowchart {
node [fontname = Helvetica, shape = rectangle, style = filled, color = grey90]
tab1 [label = '6832 references imported for screening as 6832 studies']
tab1_1 [label = '611 duplicates removed']
tab2 [label = '6221 studies screened against title and abstract']
tab2_1 [label = '4511 studies excluded']
tab3 [label = '1710 studies assessed for full-text eligibility']
tab3_1 [label =
<1544 studies excluded:<br ALIGN = 'LEFT'/>
&#8226; 1060 No ES (only EC)<br ALIGN = 'LEFT'/>
&#8226; 285 No full-text<br ALIGN = 'LEFT'/>
&#8226; 147 No EC and no ES<br ALIGN = 'LEFT'/>
&#8226; 38 No EC (only ES)<br ALIGN = 'LEFT'/>
&#8226; 13 Other<br ALIGN = 'LEFT'/>
&#8226; 1 Wrong study type<br ALIGN = 'LEFT'/> >]
tab4 [label = '166 studies included']
blank1[label = '', width = 0.01, height = 0.01]
tab1 -> blank1[dir=none];
blank1 -> tab1_1[minlen=10];
{{ rank = same; blank1 tab1_1 }}
blank1 -> tab2
blank2[label = '', width = 0.01, height = 0.01]
tab2 -> blank2[dir=none];
blank2 -> tab2_1[minlen=10];
{{ rank = same; blank2 tab2_1 }}
blank2 -> tab3
blank3[label = '', width = 0.01, height = 0.01]
tab3 -> blank3[dir=none];
blank3 -> tab3_1[minlen=10];
{{ rank = same; blank3 tab3_1 }}
blank3 -> tab4
}
")
Consensus_all <- read_excel("ALL_Extraction_Results_Feb22_edited.xlsx") |> filter(`Reviewer Name` == "Consensus")
Consensus_only_analysis <- read_excel("ALL_Extraction_Results_Feb22_edited.xlsx") |>
filter(`Reviewer Name` == "Consensus") |>
filter(`Included in analysis` == "Yes")
year_cont_plot <- ggplot(data = Consensus_only_analysis,
aes(y = `_Publication year`,
fill = `_Case study continent`)) +
geom_bar(aes(x = (..count..)/sum(..count..)),col="black") +
scale_x_continuous(labels=scales::percent,
breaks = seq(0,0.2, by=0.05),
limits = c(0,0.2)) +
xlab("% of papers") +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank(),
legend.position = "bottom") + guides(fill = guide_legend(nrow = 1,
title=NULL))
df_mode <- strsplit(Consensus_only_analysis$`_mode`, "; ", fixed = T)
df_mode <- data.frame(
id=rep(Consensus_only_analysis$`Covidence #`, lengths(df_mode)),
mode=unlist(df_mode))
df_mode <- df_mode |> group_by(mode) |>
summarize(count = n()) |>
mutate(count = count/sum(count))
mode_plot <- ggplot(data = df_mode, aes(x = forcats::fct_reorder(mode,count), y= count))+
geom_bar(stat="identity", fill = "coral2", col = "black") +
scale_y_continuous(labels=scales::percent,
breaks = seq(0,0.4, by=0.05),
limits = c(0,0.4)) +
coord_flip() +
labs(y = "% of mentions in papers", subtitle = "Modes") +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank())
df_pop <- strsplit(Consensus_only_analysis$`_population`, "; ",
fixed = T)
df_pop <- data.frame(
id=rep(Consensus_only_analysis$`Covidence #`, lengths(df_pop)),
pop=unlist(df_pop)) |>
mutate(pop = ifelse(pop == "Vulnerable populations (composite)", "Comp. vul", pop))
df_pop <- df_pop |> group_by(pop) |> summarize(count = n()) |>
mutate(count = count/sum(count))
#adding grouping var so they print on plot in the order we want
df_pop$group <- c(7,9,6,8,2,3,5,10,1,4)
pop_plot <- ggplot(data = df_pop, aes(x = pop, y = count)) +
geom_bar(stat="identity", fill = c(rep("skyblue2",each=8), "grey", "skyblue2"), col = "black") +
scale_y_continuous(labels=scales::percent, limits = c(0,0.25), breaks = seq(0,0.25, by=0.05))+
scale_x_discrete(limits=(df_pop$pop)[order(df_pop$group)]) +
coord_flip() +
labs(y = "% of mentions in papers", subtitle = "Population groups") +
theme_classic() +
theme(text=element_text(size=10),
axis.title.y = element_blank())
df_conc <- strsplit(Consensus_only_analysis$`_equity conceptualization`, "; ",
fixed = T)
df_conc <- data.frame(
id=rep(Consensus_only_analysis$`Covidence #`, lengths(df_conc)),
conc=unlist(df_conc)) %>%
mutate(conc = ifelse(conc == "Inequitable exposure to externalities", "Ineq. externalities", conc),
conc = ifelse(conc == "Sufficientarism / Capabilities approach", "Emerg. theories", conc),
conc = ifelse(conc == "Transport-related exclusion", "TR exclusion", conc))
df_standard_mcat <- strsplit(Consensus_only_analysis$`_type of equity standard2`, "; ",
fixed = T)
df_standard_mcat <- data.frame(
id=rep(Consensus_only_analysis$`Covidence #`, lengths(df_standard_mcat)),
std_mcat=unlist(df_standard_mcat))
standards_conc <- merge(df_conc, df_standard_mcat, by="id", all = T)
NUM_standards_conc <- standards_conc %>% group_by(id) %>% summarize(count = n())
NUM_ENTRIES_standards_conc <- NUM_standards_conc$count %>% sum()
standards_conc <- merge(standards_conc, NUM_standards_conc, by="id", all = T)
# standards_conc_plot <- ggplot(data = standards_conc,
#                               aes(x = `conc`, fill = `std_mcat`)) +
#   geom_bar() +
#   labs(x = "Conceptualizations (summarized)", fill = "Standards (main categories)") +
#   theme_classic() +
#   theme(text=element_text(size=10),
#         axis.title.y = element_blank(),
#         axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
#   coord_flip()
# c("Wellbeing","Vertical equity","Utilitarian","TR exclusion", "Spatial equity", "Rights", "Ineq. externalities", "Horizontal equity", "Emerg. theories")
standards_conc <- standards_conc %>%
group_by(conc, std_mcat) %>% summarize(total = n())
standards_conc <- standards_conc %>%
mutate(total_perc_in_conc = total/sum(total),
total_perc_in_all = total/NUM_ENTRIES_standards_conc)
sums_concs <- standards_conc %>% group_by(conc) %>% summarize(
total_perc_in_all = sum(total_perc_in_all),
total_perc_in_conc = 1) %>% mutate(std_mcat = "TOTAL: CONCEPT.")
new_rows <- data.frame(conc = c("Emerg. theories", "Utilitarian", "TOTAL: STANDARDS"),
total_perc_in_all = c(NA, NA, NA),
total_perc_in_conc = c(NA, NA, NA),
std_mcat = c("Environmental +","Environmental +", "TOTAL: CONCEPT."))
sums_std_mcat <- standards_conc %>% group_by(std_mcat) %>% summarize(total_perc_in_all = sum(total_perc_in_all),
total_perc_in_conc = 1) %>% mutate(conc = "TOTAL: STANDARDS")
totals_standards_conc <- rbind(standards_conc, sums_concs)
totals_standards_conc <- rbind(totals_standards_conc, sums_std_mcat)
totals_standards_conc <- rbind(totals_standards_conc, new_rows)
#adding the grouping numbers, so the order that vars are printed are in geom_tile() are chronological
totals_standards_conc$group <- c(12,13,14,
41,42,43,44,
31,32,33,34,
21,22,23,24,
51,52,53,54,
71,72,73,74,
02,03,04,
81,82,83,84,
61,62,63,64,
15,45,35,25,55,75,05,85,65,
91,92,93,94,
11,01,95)
totals_standards_conc$conc
totals_standards_conc <- totals_standards_conc %>% mutate(
conc_long = ifelse(conc == "Emerg. theories", "Emerg. theories: e.g., Sufficientarism: minimums informed by individual capabilities. Capabilities approach: the capability of living the life they value rather than simply having the right to do so",
ifelse(conc == "Horizontal equity", "Horizontal equity: The distribution of transport system benefits/costs should be equal across the population.",
ifelse(conc == "Ineq. externalities", "Ineq. externalities: Concerning the equitable distribution of externalities from transport systems (e.g., road safety, congestion, pollution).",
ifelse(conc == "Rights", "Rights: Concerning legal rights or human rights to access (e.g., mobilty rights, rights to the city, discriminatory application of laws).",
ifelse(conc == "Spatial equity", "Spatial equity: The distribution of transport system benefits/costs should be equal across space.",
ifelse(conc == "TR exclusion", "TR exclusion: Concerning the links between transport system interaction and social exclusions.",
ifelse(conc == "Utilitarian", "Utilitarian: Maximizing benefits/welfare overall, without consideration of distribution.",
ifelse(conc == "Vertical equity", "Vertical equity: The distribution of transport system benefits/costs should favourably prioritize disadvantaged groups.",
ifelse(conc == "Wellbeing", "Wellbeing: Evaluation of transport system benefits/costs through well-being measures (e.g., livability, quality of life, subjective well being).", NA)))))))))
)
totals_standards_conc$conc_long
totals_standards_conc <- totals_standards_conc %>% mutate(
conc_long = ifelse(conc == "Emerg. theories", "Emerg. theories: e.g., Sufficientarism: minimums informed by individual capabilities. Capabilities approach: the capability of living the life they value rather than simply having the right to do so",
ifelse(conc == "Horizontal equity", "Horizontal equity: The distribution of transport system benefits/costs should be equal across the population.",
ifelse(conc == "Ineq. externalities", "Ineq. externalities: Concerning the equitable distribution of externalities from transport systems (e.g., road safety, congestion, pollution).",
ifelse(conc == "Rights", "Rights: Concerning legal rights or human rights to access (e.g., mobilty rights, rights to the city, discriminatory application of laws).",
ifelse(conc == "Spatial equity", "Spatial equity: The distribution of transport system benefits/costs should be equal across space.",
ifelse(conc == "TR exclusion", "TR exclusion: Concerning the links between transport system interaction and social exclusions.",
ifelse(conc == "Utilitarian", "Utilitarian: Maximizing benefits/welfare overall, without consideration of distribution.",
ifelse(conc == "Vertical equity", "Vertical equity: The distribution of transport system benefits/costs should favourably prioritize disadvantaged groups.",
ifelse(conc == "Wellbeing", "Wellbeing: Evaluation of transport system benefits/costs through well-being measures (e.g., livability, quality of life, subjective well being).", "TOTAL: STANDARDS")))))))))
)
totals_standards_conc
totals_standards_conc$conc_long
totals_standards_conc$std_mcat
totals_standards_conc <- totals_standards_conc %>% mutate(
std_mcat_long = ifelse(std_mcat == "Infrastructure", "Infrastructure: E.g., Level of service of bus infrastructure, quality of cycling infrastructure, universal design standards.",
ifelse(std_mcat == "Environmental +", "Environmental +: E.g., noise, air, pollution criteria, safety.",
ifelse(std_mcat == "Opportunity", "Opportunity: An access to destination indicator value (e.g., number of opportunities within 30-min transit trip, a ratio of opportunity per population) or the use of travel impedance (the cost,distance or time thresholds e.g., 300m to bus stop).",
ifelse(std_mcat == "Population", "Population: Related to population that uses or could use the transport systems (e.g., transport-related affordability level, perceived equitable trip, user experiences).", "TOTAL: CONCEPT.")))))
totals_standards_conc$std_mcat_long
View(totals_standards_conc)
standards_conc_percentages_plot <- ggplot(totals_standards_conc,
aes(x=std_mcat_long, y=conc__long, fill= total_perc_in_all
#width = rep(10, each=50)
))+
geom_tile() +
scale_fill_gradient2(low = "#AFAFED", mid= "#3F3FD4", high = "#191970", midpoint = 0.2, limits = c(0,.4), na.value = "#FCB5AC") +
scale_x_discrete(limits=(totals_standards_conc$std_mcat)[order(totals_standards_conc$group)][1:5]) +
scale_y_discrete(limits=(totals_standards_conc$conc)[order(totals_standards_conc$group)] ) +
geom_text(aes(label = total_perc_in_all %>% percent(accuracy = 0.1)), color = "white", size = 4) +
labs(x = "Standards", y = "Conceptualizations")+
geom_vline(xintercept=4.5, size=1.5, color = "#191970") +
geom_hline(yintercept = 43.5, size=1.5, color="#191970")+
theme_classic() +
theme(legend.position = "none",
axis.ticks = element_blank(),
axis.text.x=element_text(angle=45,hjust=1))
standards_conc_percentages_plot
standards_conc_percentages_plot <- ggplot(totals_standards_conc,
aes(x=std_mcat_long, y=conc_long, fill= total_perc_in_all
#width = rep(10, each=50)
))+
geom_tile() +
scale_fill_gradient2(low = "#AFAFED", mid= "#3F3FD4", high = "#191970", midpoint = 0.2, limits = c(0,.4), na.value = "#FCB5AC") +
scale_x_discrete(limits=(totals_standards_conc$std_mcat)[order(totals_standards_conc$group)][1:5]) +
scale_y_discrete(limits=(totals_standards_conc$conc)[order(totals_standards_conc$group)] ) +
geom_text(aes(label = total_perc_in_all %>% percent(accuracy = 0.1)), color = "white", size = 4) +
labs(x = "Standards", y = "Conceptualizations")+
geom_vline(xintercept=4.5, size=1.5, color = "#191970") +
geom_hline(yintercept = 43.5, size=1.5, color="#191970")+
theme_classic() +
theme(legend.position = "none",
axis.ticks = element_blank(),
axis.text.x=element_text(angle=45,hjust=1))
standards_conc_percentages_plot
standards_conc_percentages_plot <- ggplot(totals_standards_conc,
aes(x=std_mcat, y=conc, fill= total_perc_in_all
#width = rep(10, each=50)
))+
geom_tile() +
scale_fill_gradient2(low = "#AFAFED", mid= "#3F3FD4", high = "#191970", midpoint = 0.2, limits = c(0,.4), na.value = "#FCB5AC") +
scale_x_discrete(limits=(totals_standards_conc$std_mcat)[order(totals_standards_conc$group)][1:5]) +
scale_y_discrete(limits=(totals_standards_conc$conc)[order(totals_standards_conc$group)] ) +
geom_text(aes(label = total_perc_in_all %>% percent(accuracy = 0.1)), color = "white", size = 4) +
labs(x = "Standards", y = "Conceptualizations")+
geom_vline(xintercept=4.5, size=1.5, color = "#191970") +
geom_hline(yintercept = 43.5, size=1.5, color="#191970")+
theme_classic() +
theme(legend.position = "none",
axis.ticks = element_blank(),
axis.text.x=element_text(angle=45,hjust=1))
standards_conc_percentages_plot
library(ggpubr)
install.packages("ggpubr")
